<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador NotificaSP · Práctica</title>
    
    <link rel="icon" type="image/png" href="../../../assets/images/icons/favicons/favicon_32.png">
    
    <link rel="stylesheet" href="../../../css/style.css">
    <link rel="stylesheet" href="notificasp.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

    <header class="sp-header">
        <img src="../../../assets/images/icons/logos/logo_Estrategia.png" class="sp-logo">
        <h1 class="sp-title">Estrategia para la Seguridad del Paciente</h1>
        <img src="../../../assets/images/icons/logos/logo_CSPyE.svg" class="sp-logo-right">
    </header>

    <main class="sp-main">
        <div class="top-bar">
            <h2><i class="fa-solid fa-bullhorn" style="color:#3b82f6;"></i> Simulador de Notificación</h2>
            <a href="../practica.html" class="btn-home"><i class="fa-solid fa-arrow-left"></i> Salir</a>
        </div>

        <div class="sim-container">
            
            <div class="sim-context">
                <div class="case-selector-box">
                    <label for="case-select"><i class="fa-solid fa-list"></i> Caso de Entrenamiento:</label>
                    <select id="case-select" class="case-dropdown"></select>
                </div>

                <div class="context-card">
                    <h3><i class="fa-solid fa-clipboard-question"></i> El Incidente</h3>
                    <p id="case-title-display" style="font-weight:bold; color:#3b82f6; margin-bottom:10px;">...</p>
                    <blockquote class="scenario-text" id="case-description-display">Cargando...</blockquote>
                </div>

                <div class="severity-legend">
                    <h4><i class="fa-solid fa-palette"></i> Clasificación del Daño</h4>
                    <div class="legend-item l-cuasi"><strong>Cuasi:</strong> No llegó al paciente.</div>
                    <div class="legend-item l-leve"><strong>Leve:</strong> Sin daño.</div>
                    <div class="legend-item l-adverso"><strong>Adverso:</strong> Daño leve/mod.</div>
                    <div class="legend-item l-centinela"><strong>Centinela:</strong> Severo/Muerte.</div>
                </div>

                <div class="alert-box-real">
                    <div class="alert-icon"><i class="fa-solid fa-triangle-exclamation"></i></div>
                    <div class="alert-content">
                        <strong>ENTORNO DE PRUEBAS</strong>
                        <p>Estás en el simulador docente. No se registrará ningún incidente real.</p>
                        <a href="https://notificasp.seguridadpaciente.es/registrar_incidente_profesional" target="_blank" class="btn-official">
                            Ir a NotificaSP (Real) <i class="fa-solid fa-external-link-alt"></i>
                        </a>
                    </div>
                </div>
            </div>

            <div class="sim-form-wrapper">
                <div class="form-header">
                    <i class="fa-solid fa-file-medical"></i> <span>Formulario de Análisis</span>
                </div>

                <form id="notifica-form" class="sim-form">
                    
                    <div class="form-row">
                        <div class="form-group half">
                            <label>Fecha del suceso</label>
                            <input type="datetime-local" id="fecha">
                        </div>
                        <div class="form-group half">
                            <label>Tipo de Incidente</label>
                            <select id="tipo">
                                <option value="">-- Selecciona --</option>
                                <option value="caida">Caída</option>
                                <option value="medicacion">Medicación</option>
                                <option value="identificacion">Identificación</option>
                                <option value="pruebas">Pruebas/Diagnóstico</option>
                                <option value="equipamiento">Equipamiento</option>
                                <option value="cuidados">Cuidados/Comunicación</option>
                            </select>
                            <div class="feedback-msg" id="msg-tipo"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Descripción del Suceso</label>
                        <textarea id="descripcion" rows="3" placeholder="Describe brevemente los hechos..."></textarea>
                        <div class="feedback-msg" id="msg-desc"></div>
                    </div>



                    <div class="form-group">
                        <label>Clasificación de Gravedad (Daño)</label>
                        <div class="radio-grid compact">
                            
                            <label class="radio-card l-cuasi">
                                <input type="radio" name="impacto" value="cuasi" class="hidden-input">
                                <span class="card-text">Cuasi-Incidente</span>
                            </label>

                            <label class="radio-card l-leve">
                                <input type="radio" name="impacto" value="leve" class="hidden-input">
                                <span class="card-text">Incidente Leve</span>
                            </label>

                            <label class="radio-card l-adverso">
                                <input type="radio" name="impacto" value="adverso" class="hidden-input">
                                <span class="card-text">Evento Adverso</span>
                            </label>

                            <label class="radio-card l-centinela">
                                <input type="radio" name="impacto" value="centinela" class="hidden-input">
                                <span class="card-text">Evento Centinela</span>
                            </label>

                        </div>
                        <div class="feedback-msg" id="msg-impacto"></div>
                    </div>

                    <div class="form-group">
                        <label>Factores Contribuyentes</label>
                        <div class="factors-grid compact">
                            <label class="check-factor"><input type="checkbox" value="paciente" class="hidden-input"> <span>Paciente</span></label>
                            <label class="check-factor"><input type="checkbox" value="profesional" class="hidden-input"> <span>Profesional</span></label>
                            <label class="check-factor"><input type="checkbox" value="tarea" class="hidden-input"> <span>Tarea</span></label>
                            <label class="check-factor"><input type="checkbox" value="comunicacion" class="hidden-input"> <span>Comunicación</span></label>
                            <label class="check-factor"><input type="checkbox" value="equipo" class="hidden-input"> <span>Equipo</span></label>
                            <label class="check-factor"><input type="checkbox" value="entorno" class="hidden-input"> <span>Entorno</span></label>
                            <label class="check-factor"><input type="checkbox" value="organizacion" class="hidden-input"> <span>Organización</span></label>
                            <label class="check-factor"><input type="checkbox" value="tecnologia" class="hidden-input"> <span>Tecnología</span></label>
                        </div>
                    </div>


                    <div class="risk-matrix-box">
                        <div class="matrix-header"><i class="fa-solid fa-chart-area"></i> Estimación de Riesgo</div>
                        <div class="matrix-body">
                            <div class="matrix-inputs">
                                <div class="matrix-input-group">
                                    <label>Gravedad</label>
                                    <div id="gravity-display" class="matrix-value-display" style="color:#94a3b8;">--</div>
                                </div>
                                <div class="matrix-input-group">
                                    <label>Frecuencia</label>
                                    <select id="frecuencia">
                                        <option value="">-- Selecciona --</option>
                                        <option value="rara">Rara</option>
                                        <option value="ocasional">Ocasional</option>
                                        <option value="frecuente">Frecuente</option>
                                    </select>
                                </div>
                            </div>
                            <div class="risk-result" id="risk-result-badge">
                                <span id="risk-label">--</span>
                            </div>
                        </div>
                        <div class="feedback-msg" id="msg-riesgo"></div>
                    </div>

                    <div class="form-group" style="margin-top:20px;">
                        <label style="color:#059669;"><i class="fa-solid fa-lightbulb"></i> Propuestas de Mejora (Barreras)</label>
                        <textarea id="propuestas" rows="2" placeholder="¿Qué harías para evitar que se repita?"></textarea>
                    </div>

                    <button type="submit" class="btn-submit"><i class="fa-regular fa-paper-plane"></i> Enviar Análisis</button>
                </form>

                <div id="final-message" class="final-message hidden">
                    <div class="final-content">
                        <i class="fa-solid fa-award success-icon"></i>
                        <h3>¡Caso Resuelto!</h3>
                        <p>Has completado el análisis correctamente.</p>
                        <p class="learning-point">...</p>
                        <div class="final-actions">
                            <button onclick="location.href='../practica.html'" class="btn-secondary"><i class="fa-solid fa-bars"></i> Menú</button>
                            <button onclick="location.reload()" class="btn-primary">Siguiente <i class="fa-solid fa-arrow-right"></i></button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <footer class="sp-footer">Área de Gestión Sanitaria Sur de Córdoba · Consejería de Sanidad, Presidencia y Emergencias</footer>
    <script type="module" src="notificasp.js"></script>
</body>
</html>